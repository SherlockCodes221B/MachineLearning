# -*- coding: utf-8 -*-
"""Loan_prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1hJ41DATP6-dZDxP-rzCFoWuJrEVCrncZ
"""

import pandas as pd

df = pd.read_csv('/content/drive/MyDrive/Colab Notebooks/LoanPrediction/train.csv')

df.head()

df.describe()

df.isnull().sum()

df.dropna(inplace=True)

df.isnull().sum()

df.head()

df = df.replace(to_replace='3+',value=4)

df.replace({'Loan_Status':{'N':0,'Y':1},'Gender':{'Male':1,'Female':0},'Self_Employed':{'Yes':1,'No':0},'Education':{'Graduate':1,'Not Graduate':0},'Property_Area':{'Rural':0,'Urban':1,'Semiurban':2},'Married':{'Yes':1,'No':0}},inplace=True)

df.head()

X = df.drop(columns=['Loan_ID','Loan_Status'],axis=1)
Y = df['Loan_Status']

from sklearn.model_selection import train_test_split
X_train,X_test,Y_train,Y_test = train_test_split(X,Y,test_size=0.1,stratify=Y,random_state=2)

from sklearn import svm
classifier = svm.SVC(kernel='linear')

classifier.fit(X_train,Y_train)

from sklearn.metrics import accuracy_score
X_train_prediction = classifier.predict(X_train)
accuracy_training = accuracy_score(X_train_prediction,Y_train)

print('Accuracy on training data : ', accuracy_training)

X_test_prediction = classifier.predict(X_test)
test_data_accuray = accuracy_score(X_test_prediction,Y_test)

print('Accuracy on test data : ', test_data_accuray)

X_new = X_test[0:5]
prediction = classifier.predict(X_new)
print(prediction)

if (prediction[0]==0):
  print('Approved Loan')
else:
  print('Loan Denied')

from sklearn.linear_model import LogisticRegression
model = LogisticRegression()
model.fit(X_train,Y_train)

x_predict = model.predict(X_test)
accuracy = accuracy_score(x_predict,Y_test)

print(accuracy)